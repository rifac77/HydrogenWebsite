{"version":3,"file":"output.js","sourceRoot":"","sources":["../src/output.ts"],"names":[],"mappings":"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","sourcesContent":["/* eslint-disable no-console */\nimport {Fatal, Bug} from './error.js'\nimport {isUnitTest, isVerbose} from './environment/local.js'\nimport constants from './constants.js'\nimport {DependencyManager} from './dependency.js'\nimport {\n  append as fileAppend,\n  mkdirSync as fileMkdirSync,\n  readSync as fileReadSync,\n  sizeSync as fileSizeSync,\n  writeSync as fileWriteSync,\n  touchSync as fileTouchSync,\n} from './file.js'\nimport {join as pathJoin, relativize as relativizePath} from './path.js'\nimport {page} from './system.js'\nimport {colors} from './colors.js'\nimport terminalLink from 'terminal-link'\nimport StackTracey from 'stacktracey'\nimport {AbortController, AbortSignal} from 'abort-controller'\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore\nimport cjs from 'color-json'\nimport stripAnsi from 'strip-ansi'\nimport {Writable} from 'node:stream'\n\nlet logFile: string\n\nexport function initiateLogging({\n  logDir = constants.paths.directories.cache.path(),\n  filename = 'shopify.log',\n}: {\n  logDir?: string\n  filename?: string\n}) {\n  fileMkdirSync(logDir)\n  logFile = pathJoin(logDir, filename)\n  fileTouchSync(logFile)\n  truncateLogs()\n}\n\n// Shaves off the first 10,000 log lines (circa 1MB) if logs are over 5MB long.\n// Rescues in case the file hasn't been created yet.\nfunction truncateLogs() {\n  try {\n    if (fileSizeSync(logFile) > 5 * 1024 * 1024) {\n      const contents = fileReadSync(logFile)\n      const splitContents = contents.split('\\n')\n      const newContents = splitContents.slice(10000, splitContents.length).join('\\n')\n      fileWriteSync(logFile, newContents)\n    }\n    // eslint-disable-next-line no-empty, no-catch-all/no-catch-all\n  } catch {}\n}\n\nenum ContentTokenType {\n  Raw,\n  Command,\n  Json,\n  Path,\n  Link,\n  Heading,\n  SubHeading,\n  Italic,\n  ErrorText,\n  Yellow,\n  Cyan,\n  Magenta,\n  Green,\n}\n\ninterface ContentMetadata {\n  link?: string\n}\n\nclass ContentToken {\n  type: ContentTokenType\n  value: Message\n  metadata: ContentMetadata\n\n  constructor(value: Message, metadata: ContentMetadata = {}, type: ContentTokenType) {\n    this.type = type\n    this.value = value\n    this.metadata = metadata\n  }\n}\n\nexport const token = {\n  raw: (value: Message) => {\n    return new ContentToken(value, {}, ContentTokenType.Raw)\n  },\n  genericShellCommand: (value: Message) => {\n    return new ContentToken(value, {}, ContentTokenType.Command)\n  },\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  json: (value: any) => {\n    return new ContentToken(value, {}, ContentTokenType.Json)\n  },\n  path: (value: Message) => {\n    return new ContentToken(value, {}, ContentTokenType.Path)\n  },\n  link: (value: Message, link: string) => {\n    return new ContentToken(value, {link}, ContentTokenType.Link)\n  },\n  heading: (value: Message) => {\n    return new ContentToken(value, {}, ContentTokenType.Heading)\n  },\n  subheading: (value: Message) => {\n    return new ContentToken(value, {}, ContentTokenType.SubHeading)\n  },\n  italic: (value: Message) => {\n    return new ContentToken(value, {}, ContentTokenType.Italic)\n  },\n  errorText: (value: Message) => {\n    return new ContentToken(value, {}, ContentTokenType.ErrorText)\n  },\n  cyan: (value: Message) => {\n    return new ContentToken(value, {}, ContentTokenType.Cyan)\n  },\n  yellow: (value: Message) => {\n    return new ContentToken(value, {}, ContentTokenType.Yellow)\n  },\n  magenta: (value: Message) => {\n    return new ContentToken(value, {}, ContentTokenType.Magenta)\n  },\n  green: (value: Message) => {\n    return new ContentToken(value, {}, ContentTokenType.Green)\n  },\n  packagejsonScript: (dependencyManager: DependencyManager, scriptName: string, ...scriptArgs: string[]) => {\n    return new ContentToken(\n      formatPackageManagerCommand(dependencyManager, scriptName, scriptArgs),\n      {},\n      ContentTokenType.Command,\n    )\n  },\n  successIcon: () => {\n    return new ContentToken('✔', {}, ContentTokenType.Green)\n  },\n  failIcon: () => {\n    return new ContentToken('✖', {}, ContentTokenType.ErrorText)\n  },\n}\n\nfunction formatPackageManagerCommand(\n  dependencyManager: DependencyManager,\n  scriptName: string,\n  scriptArgs: string[],\n): string {\n  switch (dependencyManager) {\n    case 'yarn': {\n      const pieces = ['yarn', scriptName, ...scriptArgs]\n      return pieces.join(' ')\n    }\n    case 'pnpm':\n    case 'npm': {\n      const pieces = [dependencyManager, 'run', scriptName]\n      if (scriptArgs.length > 0) {\n        pieces.push('--')\n        pieces.push(...scriptArgs)\n      }\n      return pieces.join(' ')\n    }\n  }\n}\n\nexport class TokenizedString {\n  value: string\n  constructor(value: string) {\n    this.value = value\n  }\n}\n\nexport type Message = string | TokenizedString\n\nexport function content(strings: TemplateStringsArray, ...keys: (ContentToken | string)[]): TokenizedString {\n  let output = ``\n  strings.forEach((string, i) => {\n    output += string\n    if (i >= keys.length) {\n      return\n    }\n    const token = keys[i]\n\n    if (typeof token === 'string') {\n      output += token\n    } else {\n      const enumToken = token as ContentToken\n      switch (enumToken.type) {\n        case ContentTokenType.Raw:\n          output += enumToken.value\n          break\n        case ContentTokenType.Command:\n          output += colors.bold(colors.yellow(stringifyMessage(enumToken.value)))\n          break\n        case ContentTokenType.Path:\n          output += relativizePath(stringifyMessage(enumToken.value))\n          break\n        case ContentTokenType.Json:\n          try {\n            output += cjs(stringifyMessage(enumToken.value) ?? {})\n            // eslint-disable-next-line no-catch-all/no-catch-all\n          } catch (_) {\n            output += JSON.stringify(stringifyMessage(enumToken.value) ?? {}, null, 2)\n          }\n          break\n        case ContentTokenType.Link:\n          output += terminalLink(colors.green(stringifyMessage(enumToken.value)), enumToken.metadata.link ?? '')\n          break\n        case ContentTokenType.Heading:\n          output += colors.bold.underline(stringifyMessage(enumToken.value))\n          break\n        case ContentTokenType.SubHeading:\n          output += colors.underline(stringifyMessage(enumToken.value))\n          break\n        case ContentTokenType.Italic:\n          output += colors.italic(stringifyMessage(enumToken.value))\n          break\n        case ContentTokenType.ErrorText:\n          output += colors.bold.redBright(stringifyMessage(enumToken.value))\n          break\n        case ContentTokenType.Yellow:\n          output += colors.yellow(stringifyMessage(enumToken.value))\n          break\n        case ContentTokenType.Cyan:\n          output += colors.cyan(stringifyMessage(enumToken.value))\n          break\n        case ContentTokenType.Magenta:\n          output += colors.magenta(stringifyMessage(enumToken.value))\n          break\n        case ContentTokenType.Green:\n          output += colors.green(stringifyMessage(enumToken.value))\n          break\n      }\n    }\n  })\n  return new TokenizedString(output)\n}\n\n/** Log levels */\nexport type LogLevel = 'fatal' | 'error' | 'warn' | 'info' | 'debug' | 'trace' | 'silent'\n\n/**\n * It maps a level to a numeric value.\n * @param level {LogLevel} The level for which we'll return its numeric value.\n * @returns The numeric value of the level.\n */\nconst logLevelValue = (level: LogLevel): number => {\n  switch (level) {\n    case 'trace':\n      return 10\n    case 'debug':\n      return 20\n    case 'info':\n      return 30\n    case 'warn':\n      return 40\n    case 'error':\n      return 50\n    case 'fatal':\n      return 60\n    default:\n      return 30\n  }\n}\n\n/**\n *\n * @returns {LogLevel} It returns the log level set by the user.\n */\nexport const currentLogLevel = (): LogLevel => {\n  if (isVerbose()) {\n    return 'debug'\n  } else {\n    return 'info'\n  }\n}\n\nexport const shouldOutput = (logLevel: LogLevel): boolean => {\n  if (isUnitTest()) {\n    return false\n  }\n  const currentLogLevelValue = logLevelValue(currentLogLevel())\n  const messageLogLevelValue = logLevelValue(logLevel)\n  return messageLogLevelValue >= currentLogLevelValue\n}\n\n// eslint-disable-next-line import/no-mutable-exports\nexport let collectedLogs: {[key: string]: string[]} = {}\n\n/**\n * This is only used during UnitTesting.\n * If we are in a testing context, instead of printing the logs to the console,\n * we will store them in a variable that can be accessed from the tests.\n * @param key {string} The key of the log.\n * @param content {string} The content of the log.\n */\nconst collectLog = (key: string, content: Message) => {\n  const output = collectedLogs.output ?? []\n  const data = collectedLogs[key] ?? []\n  data.push(stripAnsi(stringifyMessage(content) ?? ''))\n  output.push(stripAnsi(stringifyMessage(content) ?? ''))\n  collectedLogs[key] = data\n  collectedLogs.output = output\n}\n\nexport const clearCollectedLogs = () => {\n  collectedLogs = {}\n}\n\n/**\n * Ouputs information to the user. This is akin to \"console.log\"\n * Info messages don't get additional formatting.\n * Note: Info messages are sent through the standard output.\n * @param content {string} The content to be output to the user.\n */\nexport const info = (content: Message) => {\n  if (isUnitTest()) collectLog('info', content)\n  message(content, 'info')\n}\n\n/**\n * Outputs a success message to the user.\n * Success message receive a special formatting to make them stand out in the console.\n * Note: Success messages are sent through the standard output.\n * @param content {string} The content to be output to the user.\n */\nexport const success = (content: Message) => {\n  const message = colors.bold(`✅ Success! ${stringifyMessage(content)}.`)\n  if (isUnitTest()) collectLog('success', content)\n  outputWhereAppropriate('info', consoleLog, message)\n}\n\n/**\n * Outputs a completed message to the user.\n * Completed message receive a special formatting to make them stand out in the console.\n * Note: Completed messages are sent through the standard output.\n * @param content {string} The content to be output to the user.\n */\nexport const completed = (content: Message) => {\n  const message = `${colors.green('✔')} ${stringifyMessage(content)}`\n  if (isUnitTest()) collectLog('completed', content)\n  outputWhereAppropriate('info', consoleLog, message)\n}\n\n/**\n * Ouputs debug information to the user. By default these output is hidden unless the user calls the CLI with --verbose.\n * Debug messages don't get additional formatting.\n * Note: Debug messages are sent through the standard output.\n * @param content {string} The content to be output to the user.\n */\nexport const debug = (content: Message) => {\n  if (isUnitTest()) collectLog('debug', content)\n  message(colors.gray(stringifyMessage(content)), 'debug')\n}\n\n/**\n * Outputs a warning message to the user.\n * Warning messages receive a special formatting to make them stand out in the console.\n * Note: Warning messages are sent through the standard output.\n * @param content {string} The content to be output to the user.\n */\nexport const warn = (content: Message) => {\n  if (isUnitTest()) collectLog('warn', content)\n  consoleWarn(colors.yellow(stringifyMessage(content)))\n}\n\n/**\n * Prints a new line in the terminal.\n */\nexport const newline = () => {\n  console.log()\n}\n\n/**\n * Formats and outputs a fatal error.\n * Note: This API is not intended to be used internally. If you want to\n * abort the execution due to an error, raise a fatal error and let the\n * error handler handle and format it.\n * @param content {Fatal} The fatal error to be output.\n */\nexport const error = async (content: Fatal) => {\n  if (!content.message) {\n    return\n  }\n  let outputString = ''\n  const message = content.message\n  const padding = '    '\n  const header = colors.redBright(`\\n━━━━━━ Error ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\\n`)\n  const footer = colors.redBright('\\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\\n')\n  outputString += header\n  const lines = message.split('\\n')\n  for (const line of lines) {\n    outputString += `${padding}${line}\\n`\n  }\n  if (content.tryMessage) {\n    outputString += `\\n${padding}${colors.bold('What to try:')}\\n`\n    const lines = content.tryMessage.split('\\n')\n    for (const line of lines) {\n      outputString += `${padding}${line}\\n`\n    }\n  }\n\n  let stack = await new StackTracey(content).withSourcesAsync()\n  stack = stack\n    .filter((entry) => {\n      return !entry.file.includes('@oclif/core')\n    })\n    .map((item) => {\n      item.calleeShort = colors.yellow(item.calleeShort)\n      /** We make the paths relative to the packages/ directory */\n      const fileShortComponents = item.fileShort.split('packages/')\n      item.fileShort = fileShortComponents.length === 2 ? fileShortComponents[1] : fileShortComponents[0]\n      return item\n    })\n  if (content instanceof Bug) {\n    if (stack.items.length !== 0) {\n      outputString += `\\n${padding}${colors.bold('Stack trace:')}`\n      const stackLines = stack.asTable({}).split('\\n')\n      for (const stackLine of stackLines) {\n        outputString += `${padding}${stackLine}\\n`\n      }\n    }\n  }\n  outputString += footer\n  outputWhereAppropriate('error', consoleError, outputString)\n}\n\nexport function stringifyMessage(message: Message): string {\n  if (message instanceof TokenizedString) {\n    return message.value\n  } else {\n    return message\n  }\n}\n\nconst message = (content: Message, level: LogLevel = 'info') => {\n  const stringifiedMessage = stringifyMessage(content)\n  outputWhereAppropriate(level, consoleLog, stringifiedMessage)\n}\n\nexport interface OutputProcess {\n  /** The prefix to include in the logs\n   *   [vite] Output coming from Vite\n   */\n  prefix: string\n  /**\n   * A callback to invoke the process. stdout and stderr should be used\n   * to send standard output and error data that gets formatted with the\n   * right prefix.\n   */\n  action: (stdout: Writable, stderr: Writable, signal: AbortSignal) => Promise<void>\n}\n\n/**\n * Use this function when you have multiple concurrent processes that send data events\n * and we need to output them ensuring that they can visually differenciated by the user.\n *\n * @param processes {OutputProcess[]} A list of processes to run concurrently.\n */\nexport async function concurrent(\n  processes: OutputProcess[],\n  callback: ((signal: AbortSignal) => void) | undefined = undefined,\n) {\n  const abortController = new AbortController()\n\n  // eslint-disable-next-line node/callback-return\n  if (callback) callback(abortController.signal)\n\n  const concurrentColors = [token.yellow, token.cyan, token.magenta, token.green]\n  const prefixColumnSize = Math.max(...processes.map((process) => process.prefix.length))\n\n  function linePrefix(prefix: string, index: number) {\n    const colorIndex = index < concurrentColors.length ? index : index % concurrentColors.length\n    const color = concurrentColors[colorIndex]\n    return color(`${prefix}${' '.repeat(prefixColumnSize - prefix.length)} ${colors.bold('|')} `)\n  }\n\n  try {\n    await Promise.all(\n      processes.map(async (process, index) => {\n        const stdout = new Writable({\n          write(chunk, _encoding, next) {\n            const lines = stripAnsiEraseCursorEscapeCharacters(chunk.toString('ascii')).split(/\\n/)\n            for (const line of lines) {\n              info(content`${linePrefix(process.prefix, index)}${line}`)\n            }\n            next()\n          },\n        })\n        const stderr = new Writable({\n          write(chunk, _encoding, next) {\n            const lines = stripAnsiEraseCursorEscapeCharacters(chunk.toString('ascii')).split(/\\n/)\n            for (const line of lines) {\n              message(content`${linePrefix(process.prefix, index)}${colors.bold(line)}`, 'error')\n            }\n            next()\n          },\n        })\n        await process.action(stdout, stderr, abortController.signal)\n      }),\n    )\n  } catch (_error) {\n    // We abort any running process\n    abortController.abort()\n    throw _error\n  }\n}\n\n/**\n * This regex can be used to find the erase cursor Ansii characters\n * to strip them from the string.\n * https://gist.github.com/fnky/458719343aabd01cfb17a3a4f7296797#erase-functions\n */\nconst eraseCursorAnsiRegex = [\n  // Erase the entire line\n  '2K',\n  // Clear vertical tab stop at current line\n  '1G',\n]\n  .map((element) => `[\\\\u001B\\\\u009B][[\\\\]()#;?]*${element}`)\n  .join('|')\n\n/**\n * The data sent through the standard pipelines of the sub-processes that we execute\n * might contain ansii escape characters to move the cursor. That causes any additional\n * formatting to break. This function takes a string and strips escape characters that\n * manage the cursor in the terminal.\n * @param value {string} String whose erase cursor escape characters will be stripped.\n * @returns {string} Stripped string.\n */\nfunction stripAnsiEraseCursorEscapeCharacters(value: string): string {\n  return value.replace(/(\\n)$/, '').replace(new RegExp(eraseCursorAnsiRegex, 'g'), '')\n}\n\nfunction consoleLog(message: string): void {\n  console.log(withOrWithoutStyle(message))\n}\n\nfunction consoleError(message: string): void {\n  console.error(withOrWithoutStyle(message))\n}\n\nfunction consoleWarn(message: string): void {\n  console.warn(withOrWithoutStyle(message))\n}\n\nfunction outputWhereAppropriate(logLevel: LogLevel, logFunc: (message: string) => void, message: string): void {\n  if (shouldOutput(logLevel)) {\n    logFunc(message)\n  }\n  logToFile(message, logLevel.toUpperCase())\n}\n\nexport function logFileExists(): boolean {\n  return Boolean(logFile)\n}\n\n// DO NOT USE THIS FUNCTION DIRECTLY under normal circumstances.\n// It is exported purely for use in cases where output is already being logged\n// to the terminal but is not reflected in the logfile, e.g. Listr output.\nexport function logToFile(message: string, logLevel: string): void {\n  // If file logging hasn't been initiated, skip it\n  if (!logFileExists()) return\n  const timestamp = new Date().toISOString()\n  fileAppend(logFile, `[${timestamp} ${logLevel}]: ${message}\\n`)\n}\n\nfunction withOrWithoutStyle(message: string): string {\n  if (shouldDisplayColors()) {\n    return message\n  } else {\n    return unstyled(message)\n  }\n}\n\nexport function unstyled(message: string): string {\n  return colors.unstyle(message)\n}\n\nexport function shouldDisplayColors(): boolean {\n  return Boolean(process.stdout.isTTY || process.env.FORCE_COLOR)\n}\n\nexport async function pageLogs() {\n  await page(logFile)\n}\n\n/* eslint-enable no-console */\n"]}